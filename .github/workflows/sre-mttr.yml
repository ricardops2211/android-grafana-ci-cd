name: SRE-MTTR-Pipeline
on:
  push: { branches: ["reusable-sre-richie-quitar"] }
  workflow_dispatch: {}

jobs:
  cluster:
    uses: ./.github/workflows/rw_cluster.yml

  observability:
    needs: [cluster]
    uses: ./.github/workflows/rw_observability.yml
    with:
      GC_PROM_URL: ${{ secrets.GC_PROM_URL }}
    secrets: inherit   # pasa secrets del repo

  incident:
    needs: [observability]
    uses: ./.github/workflows/rw_incident.yml
    secrets: inherit

  grafana:
    needs: [incident]
    uses: ./.github/workflows/rw_grafana.yml
    with:
      grafana_url: https://ricardops2211.grafana.net
      loki_ds_name: grafanacloud-ricardops2211-logs
      dashboard_uid: sre-mttr-lab
      dashboard_title: "SRE MTTR Lab"
    secrets: inherit
